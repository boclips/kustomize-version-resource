#!/usr/bin/env bash

get () {
    jq --raw-output ".$1.$2 // empty"
}

clone () {
    uri="$1"
    destination="$2"
    branch="$3"
    private_key="$4"

    mkdir --parents ~/.ssh
    ssh-keyscan github.com \
        > ~/.ssh/known_hosts \
        2> /dev/null
    echo "$private_key" > ~/.ssh/id_rsa

    chmod 0400 ~/.ssh/id_rsa

    [ -d "$destination" ] \
        || git clone "$uri" "$destination"
    git -C "$destination" fetch --quiet
    git -C "$destination" checkout --quiet "$branch"
}
